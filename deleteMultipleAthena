import json
import boto3
import io
import re
import time

def lambda_handler(event, context):
    # TODO implement
    return {
        'statusCode': 200,
        'body': json.dumps('Hello from Lambda!')
    }
    
tbl_lst=['"part_00391_fdcd5dcb_1e1b_48a1_9c21_3926f9abddc8_c000_snappy_parquet",']
													  

session = boto3.Session()
def athena_query(client, params):
    response = client.start_query_execution(
        QueryString=params["query"],
        QueryExecutionContext={
            'Database': params['database']
        },
        ResultConfiguration={
            'OutputLocation': 's3://' + params['bucket'] + '/' + params['path']
        }
    )
    
    #print(response)
    return response

for tbl in tbl_lst:
    params = {
        'region': 'af-south-1',
        'database': 'database_drc',
        'bucket': 'vodacom-mpesa-tanzania-357579987446-raw',
        'path': 'AthenaTestResults/kaylin',
        'query': f'drop table {tbl}'
    }
    client = session.client('athena', region_name=params["region"])
    execution = athena_query(client, params)
    execution_id = execution['QueryExecutionId']
    response1 = client.get_query_execution(QueryExecutionId = execution_id)
    print("kaylin")



   
    


